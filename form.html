<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Enter Scores</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; line-height: 1.5; }
      .section { margin-bottom: 28px; }
      .card { border: 1px solid #ddd; border-radius: 12px; padding: 16px; margin: 12px 0; }
      .row { display: grid; grid-template-columns: 1fr 140px 110px 110px; gap: 8px; align-items: center; }
      label { font-weight: 600; }
      input[type="number"], input[type="text"] { padding: 8px; border: 1px solid #ccc; border-radius: 8px; width: 100%; }
      .hint { color: #666; font-size: 12px; }
      .btn { display: inline-block; padding: 10px 16px; border-radius: 10px; border: 1px solid #ccc; text-decoration: none; }
      .weight { font-size: 12px; color: #555; }
    </style>
  </head>
  <body>
    <h2>Enter KPI Inputs</h2>
    <form method="post" action="/result">
      {% for dim, plist in grouped.items() %}
        <div class="section">
          <h3>{{ dim }}</h3>
          <div class="card">
            <div class="row" style="font-weight:700;">
              <div>Sub-Parameter / KPI</div>
              <div>Raw Value (opt.)</div>
              <div>Score (1–5)</div>
              <div>Weight %</div>
            </div>
            {% for p in plist %}
              <div class="row">
                <div>
                  <label>{{ p.sub_parameter }}</label><br/>
                  <div class="hint">{{ p.kpi }}{% if p.unit_or_type %} • {{ p.unit_or_type }}{% endif %}</div>
                  {% if p.scoring_guidance %}<div class="hint">Guidance: {{ p.scoring_guidance }}</div>{% endif %}
                </div>
                <div><input type="text" name="raw__{{ p.sub_parameter }}" placeholder="e.g. 3.5"></div>
                <div><input type="number" name="score__{{ p.sub_parameter }}" min="0" max="5" step="0.1" required></div>
                <div class="weight">{{ '%.2f'|format(p.weight_pct) }}%</div>
              </div>
            {% endfor %}
          </div>
        </div>
      {% endfor %}
      <button class="btn" type="submit">Calculate →</button>
    </form>
  </body>
</html>
